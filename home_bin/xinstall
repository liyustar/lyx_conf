#!/bin/bash

APP=('redis' 'jdk' 'svn')
INDEX=
URL=('http://download.redis.io/releases/redis-3.0.0.tar.gz' '')
INSTALL_FUN=('' '' install_svn)

# init
LEN=${#APP[@]}
for ((i=0; i<$LEN; i++)); do
    INDEX[${APP[$i]}]=$i
done

# 安装SVN,作配置
function install_svn {
if [ ! -e $HOME/.subversion ]; then
    echo 'error ~/.subversion not found'
    exit 1
fi

sed -i 's/.*editor-cmd =.*/editor-cmd = vim/' $HOME/.subversion/config
sed -i 's/.*diff-cmd =.*/diff-cmd = colordiff/' $HOME/.subversion/config
echo 'install_svn DONE!'
}

while getopts "ld:a:bci:" arg
do
    case $arg in
        l)  # list
            # find pkg
            for x in $(ls); do
                # for app in APP
                # if $x = app; then DIR[I] = $x
                echo $x
            done
            exit 0
            # list app
            for ((i=0; i<$LEN; i++)); do
                echo -e "$i) ${APP[$i]}\t${URL[$i]}"
            done
            ;;
        d)  # download
            URL_TO_DOWNLOAD=${URL[$OPTARG]}
            APP_TO_DOWNLOAD=${APP[$OPTARG]}
            if [ -n $URL_TO_DOWNLOAD ]; then
                echo "begin download $APP_TO_DOWNLOAD"
                wget $URL_TO_DOWNLOAD
                echo "end download $APP_TO_DOWNLOAD"
            else
                echo "error download: argument invaild"
                exit 1
            fi
            ;;
        b)
            if [ ! -n $OPTARG ]; then
                echo "xx"
            else
                echo "optarg: " $OPTARG
            fi
            ;;
        i)  # install
            ${INSTALL_FUN[$OPTARG]}
            ;;
        ?)
            echo "unknow argument"
            exit 1
            ;;
    esac
done

